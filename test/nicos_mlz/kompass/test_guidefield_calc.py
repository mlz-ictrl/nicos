# *****************************************************************************
# NICOS, the Networked Instrument Control System of the MLZ
# Copyright (c) 2009-2025 by the NICOS contributors (see AUTHORS)
#
# This program is free software; you can redistribute it and/or modify it under
# the terms of the GNU General Public License as published by the Free Software
# Foundation; either version 2 of the License, or (at your option) any later
# version.
#
# This program is distributed in the hope that it will be useful, but WITHOUT
# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
# FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
# details.
#
# You should have received a copy of the GNU General Public License along with
# this program; if not, write to the Free Software Foundation, Inc.,
# 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#
# Module author:
#   Jens Kr√ºger <jens.krueger@frm2.tum.de>
#
# *****************************************************************************
"""Test the guide field calculations."""

import pytest

session_setup = 'lpa_kompass'


@pytest.mark.parametrize(('alpha', 'field', 'currents'), [
    (0, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (0, [0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (0, [0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (0, [-0.100, -0.173, 0.000], [-0.500, -0.499, 0.500, 0.000]),
    (0, [-0.100, -0.173, 0.900], [-0.500, -0.499, 0.499, 1.000]),
    (0, [-0.100, -0.173, 1.800], [-0.500, -0.499, 0.499, 2.000]),
    (0, [-0.200, -0.346, 0.000], [-1.000, -0.999, 0.999, 0.000]),
    (0, [-0.200, -0.346, 0.900], [-1.000, -0.999, 0.999, 1.000]),
    (0, [-0.200, -0.346, 1.800], [-1.000, -0.999, 0.999, 2.000]),
    (0, [-0.100, 0.173, 0.000], [-0.500, 0.500, -0.499, 0.000]),
    (0, [-0.100, 0.173, 0.900], [-0.500, 0.499, -0.499, 1.000]),
    (0, [-0.100, 0.173, 1.800], [-0.500, 0.499, -0.499, 2.000]),
    (0, [-0.200, 0.000, 0.000], [-0.500, 0.500, 0.500, 0.000]),
    (0, [-0.200, 0.000, 0.900], [-1.000, 0.000, 0.000, 1.000]),
    (0, [-0.200, 0.000, 1.800], [-1.000, 0.000, 0.000, 2.000]),
    (0, [-0.300, -0.173, 0.000], [-0.999, 0.001, 1.000, 0.000]),
    (0, [-0.300, -0.173, 0.900], [-1.500, -0.499, 0.499, 1.000]),
    (0, [-0.300, -0.173, 1.800], [-1.500, -0.499, 0.499, 2.000]),
    (0, [-0.200, 0.346, 0.000], [-1.000, 0.999, -0.999, 0.000]),
    (0, [-0.200, 0.346, 0.900], [-1.000, 0.999, -0.999, 1.000]),
    (0, [-0.200, 0.346, 1.800], [-1.000, 0.999, -0.999, 2.000]),
    (0, [-0.300, 0.173, 0.000], [-0.999, 1.000, 0.001, 0.000]),
    (0, [-0.300, 0.173, 0.900], [-1.500, 0.499, -0.499, 1.000]),
    (0, [-0.300, 0.173, 1.800], [-1.500, 0.499, -0.499, 2.000]),
    (0, [-0.400, 0.000, 0.000], [-1.000, 1.000, 1.000, 0.000]),
    (0, [-0.400, 0.000, 0.900], [-2.000, 0.000, 0.000, 1.000]),
    (0, [-0.400, 0.000, 1.800], [-2.000, 0.000, 0.000, 2.000]),
    (0, [0.200, 0.000, 0.000], [0.500, -0.500, -0.500, 0.000]),
    (0, [0.200, 0.000, 0.900], [1.000, 0.000, 0.000, 1.000]),
    (0, [0.200, 0.000, 1.800], [1.000, 0.000, 0.000, 2.000]),
    (0, [0.100, -0.173, 0.000], [0.500, -0.500, 0.499, 0.000]),
    (0, [0.100, -0.173, 0.900], [0.500, -0.499, 0.499, 1.000]),
    (0, [0.100, -0.173, 1.800], [0.500, -0.499, 0.499, 2.000]),
    (0, [-0.000, -0.346, 0.000], [0.000, -0.999, 0.999, 0.000]),
    (0, [-0.000, -0.346, 0.900], [0.000, -0.999, 0.999, 1.000]),
    (0, [-0.000, -0.346, 1.800], [0.000, -0.999, 0.999, 2.000]),
    (0, [0.100, 0.173, 0.000], [0.500, 0.499, -0.500, 0.000]),
    (0, [0.100, 0.173, 0.900], [0.500, 0.499, -0.499, 1.000]),
    (0, [0.100, 0.173, 1.800], [0.500, 0.499, -0.499, 2.000]),
    (0, [-0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (0, [-0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (0, [-0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (0, [0.000, 0.346, 0.000], [-0.000, 0.999, -0.999, 0.000]),
    (0, [0.000, 0.346, 0.900], [0.000, 0.999, -0.999, 1.000]),
    (0, [0.000, 0.346, 1.800], [0.000, 0.999, -0.999, 2.000]),
    (0, [0.400, 0.000, 0.000], [1.000, -1.000, -1.000, 0.000]),
    (0, [0.400, 0.000, 0.900], [2.000, 0.000, 0.000, 1.000]),
    (0, [0.400, 0.000, 1.800], [2.000, 0.000, 0.000, 2.000]),
    (0, [0.300, -0.173, 0.000], [0.999, -1.000, -0.001, 0.000]),
    (0, [0.300, -0.173, 0.900], [1.500, -0.499, 0.499, 1.000]),
    (0, [0.300, -0.173, 1.800], [1.500, -0.499, 0.499, 2.000]),
    (0, [0.200, -0.346, 0.000], [1.000, -0.999, 0.999, 0.000]),
    (0, [0.200, -0.346, 0.900], [1.000, -0.999, 0.999, 1.000]),
    (0, [0.200, -0.346, 1.800], [1.000, -0.999, 0.999, 2.000]),
    (0, [0.300, 0.173, 0.000], [0.999, -0.001, -1.000, 0.000]),
    (0, [0.300, 0.173, 0.900], [1.500, 0.499, -0.499, 1.000]),
    (0, [0.300, 0.173, 1.800], [1.500, 0.499, -0.499, 2.000]),
    (0, [0.200, 0.346, 0.000], [1.000, 0.999, -0.999, 0.000]),
    (0, [0.200, 0.346, 0.900], [1.000, 0.999, -0.999, 1.000]),
    (0, [0.200, 0.346, 1.800], [1.000, 0.999, -0.999, 2.000]),

    (10, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (10, [0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (10, [0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (10, [-0.068, -0.188, 0.000], [-0.499, -0.501, 0.500, 0.000]),
    (10, [-0.068, -0.188, 0.900], [-0.498, -0.500, 0.500, 1.000]),
    (10, [-0.068, -0.188, 1.800], [-0.498, -0.500, 0.500, 2.000]),
    (10, [-0.137, -0.376, 0.000], [-1.001, -1.000, 1.000, 0.000]),
    (10, [-0.137, -0.376, 0.900], [-1.001, -1.000, 1.000, 1.000]),
    (10, [-0.137, -0.376, 1.800], [-1.001, -1.000, 1.000, 2.000]),
    (10, [-0.129, 0.153, 0.000], [-0.502, 0.500, -0.499, 0.000]),
    (10, [-0.129, 0.153, 0.900], [-0.502, 0.500, -0.500, 1.000]),
    (10, [-0.129, 0.153, 1.800], [-0.502, 0.500, -0.500, 2.000]),
    (10, [-0.197, -0.035, 0.000], [-0.500, 0.499, 0.501, 0.000]),
    (10, [-0.197, -0.035, 0.900], [-1.000, -0.001, 0.001, 1.000]),
    (10, [-0.197, -0.035, 1.800], [-1.000, -0.001, 0.001, 2.000]),
    (10, [-0.265, -0.223, 0.000], [-1.001, -0.003, 0.999, 0.000]),
    (10, [-0.265, -0.223, 0.900], [-1.498, -0.501, 0.501, 1.000]),
    (10, [-0.265, -0.223, 1.800], [-1.498, -0.501, 0.501, 2.000]),
    (10, [-0.257, 0.306, 0.000], [-1.000, 0.999, -0.998, 0.000]),
    (10, [-0.257, 0.306, 0.900], [-1.000, 0.999, -0.999, 1.000]),
    (10, [-0.257, 0.306, 1.800], [-1.000, 0.999, -0.999, 2.000]),
    (10, [-0.326, 0.118, 0.000], [-1.000, 1.002, 0.004, 0.000]),
    (10, [-0.326, 0.118, 0.900], [-1.503, 0.499, -0.499, 1.000]),
    (10, [-0.326, 0.118, 1.800], [-1.503, 0.499, -0.499, 2.000]),
    (10, [-0.394, -0.069, 0.000], [-1.000, 1.001, 0.999, 0.000]),
    (10, [-0.394, -0.069, 0.900], [-2.000, 0.001, -0.001, 1.000]),
    (10, [-0.394, -0.069, 1.800], [-2.000, 0.001, -0.001, 2.000]),
    (10, [0.197, 0.035, 0.000], [0.500, -0.499, -0.501, 0.000]),
    (10, [0.197, 0.035, 0.900], [1.000, 0.001, -0.001, 1.000]),
    (10, [0.197, 0.035, 1.800], [1.000, 0.001, -0.001, 2.000]),
    (10, [0.129, -0.153, 0.000], [0.502, -0.500, 0.499, 0.000]),
    (10, [0.129, -0.153, 0.900], [0.502, -0.500, 0.500, 1.000]),
    (10, [0.129, -0.153, 1.800], [0.502, -0.500, 0.500, 2.000]),
    (10, [0.060, -0.341, 0.000], [-0.001, -1.000, 0.999, 0.000]),
    (10, [0.060, -0.341, 0.900], [-0.001, -1.000, 1.000, 1.000]),
    (10, [0.060, -0.341, 1.800], [-0.001, -1.000, 1.000, 2.000]),
    (10, [0.068, 0.188, 0.000], [0.499, 0.501, -0.500, 0.000]),
    (10, [0.068, 0.188, 0.900], [0.498, 0.500, -0.500, 1.000]),
    (10, [0.068, 0.188, 1.800], [0.498, 0.500, -0.500, 2.000]),
    (10, [-0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (10, [-0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (10, [-0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (10, [-0.060, 0.341, 0.000], [0.001, 1.000, -0.999, 0.000]),
    (10, [-0.060, 0.341, 0.900], [0.001, 1.000, -1.000, 1.000]),
    (10, [-0.060, 0.341, 1.800], [0.001, 1.000, -1.000, 2.000]),
    (10, [0.394, 0.069, 0.000], [1.000, -1.001, -0.999, 0.000]),
    (10, [0.394, 0.069, 0.900], [2.000, -0.001, 0.001, 1.000]),
    (10, [0.394, 0.069, 1.800], [2.000, -0.001, 0.001, 2.000]),
    (10, [0.326, -0.118, 0.000], [1.000, -1.002, -0.004, 0.000]),
    (10, [0.326, -0.118, 0.900], [1.503, -0.499, 0.499, 1.000]),
    (10, [0.326, -0.118, 1.800], [1.503, -0.499, 0.499, 2.000]),
    (10, [0.257, -0.306, 0.000], [1.000, -0.999, 0.998, 0.000]),
    (10, [0.257, -0.306, 0.900], [1.000, -0.999, 0.999, 1.000]),
    (10, [0.257, -0.306, 1.800], [1.000, -0.999, 0.999, 2.000]),
    (10, [0.265, 0.223, 0.000], [1.001, 0.003, -0.999, 0.000]),
    (10, [0.265, 0.223, 0.900], [1.498, 0.501, -0.501, 1.000]),
    (10, [0.265, 0.223, 1.800], [1.498, 0.501, -0.501, 2.000]),
    (10, [0.137, 0.376, 0.000], [1.001, 1.000, -1.000, 0.000]),
    (10, [0.137, 0.376, 0.900], [1.001, 1.000, -1.000, 1.000]),
    (10, [0.137, 0.376, 1.800], [1.001, 1.000, -1.000, 2.000]),

    (20, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (20, [0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (20, [0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (20, [-0.035, -0.197, 0.000], [-0.501, -0.499, 0.500, 0.000]),
    (20, [-0.035, -0.197, 0.900], [-0.501, -0.500, 0.500, 1.000]),
    (20, [-0.035, -0.197, 1.800], [-0.501, -0.500, 0.500, 2.000]),
    (20, [-0.069, -0.394, 0.000], [-0.999, -1.001, 1.000, 0.000]),
    (20, [-0.069, -0.394, 0.900], [-0.998, -1.001, 1.001, 1.000]),
    (20, [-0.069, -0.394, 1.800], [-0.998, -1.001, 1.001, 2.000]),
    (20, [-0.153, 0.129, 0.000], [-0.499, 0.500, -0.502, 0.000]),
    (20, [-0.153, 0.129, 0.900], [-0.498, 0.501, -0.501, 1.000]),
    (20, [-0.153, 0.129, 1.800], [-0.498, 0.501, -0.501, 2.000]),
    (20, [-0.188, -0.068, 0.000], [-0.500, 0.501, 0.499, 0.000]),
    (20, [-0.188, -0.068, 0.900], [-1.000, 0.001, -0.001, 1.000]),
    (20, [-0.188, -0.068, 1.800], [-1.000, 0.001, -0.001, 2.000]),
    (20, [-0.223, -0.265, 0.000], [-0.999, 0.003, 1.001, 0.000]),
    (20, [-0.223, -0.265, 0.900], [-1.501, -0.499, 0.499, 1.000]),
    (20, [-0.223, -0.265, 1.800], [-1.501, -0.499, 0.499, 2.000]),
    (20, [-0.306, 0.257, 0.000], [-0.998, 0.999, -1.000, 0.000]),
    (20, [-0.306, 0.257, 0.900], [-0.998, 0.999, -0.999, 1.000]),
    (20, [-0.306, 0.257, 1.800], [-0.998, 0.999, -0.999, 2.000]),
    (20, [-0.341, 0.060, 0.000], [-0.999, 1.000, 0.001, 0.000]),
    (20, [-0.341, 0.060, 0.900], [-1.500, 0.499, -0.499, 1.000]),
    (20, [-0.341, 0.060, 1.800], [-1.500, 0.499, -0.499, 2.000]),
    (20, [-0.376, -0.137, 0.000], [-1.000, 1.000, 1.001, 0.000]),
    (20, [-0.376, -0.137, 0.900], [-2.001, -0.000, 0.000, 1.000]),
    (20, [-0.376, -0.137, 1.800], [-2.001, -0.000, 0.000, 2.000]),
    (20, [0.188, 0.068, 0.000], [0.500, -0.501, -0.499, 0.000]),
    (20, [0.188, 0.068, 0.900], [1.000, -0.001, 0.001, 1.000]),
    (20, [0.188, 0.068, 1.800], [1.000, -0.001, 0.001, 2.000]),
    (20, [0.153, -0.129, 0.000], [0.499, -0.500, 0.502, 0.000]),
    (20, [0.153, -0.129, 0.900], [0.498, -0.501, 0.501, 1.000]),
    (20, [0.153, -0.129, 1.800], [0.498, -0.501, 0.501, 2.000]),
    (20, [0.118, -0.326, 0.000], [-0.004, -1.002, 1.000, 0.000]),
    (20, [0.118, -0.326, 0.900], [-0.003, -1.001, 1.001, 1.000]),
    (20, [0.118, -0.326, 1.800], [-0.003, -1.001, 1.001, 2.000]),
    (20, [0.035, 0.197, 0.000], [0.501, 0.499, -0.500, 0.000]),
    (20, [0.035, 0.197, 0.900], [0.501, 0.500, -0.500, 1.000]),
    (20, [0.035, 0.197, 1.800], [0.501, 0.500, -0.500, 2.000]),
    (20, [-0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (20, [-0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (20, [-0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (20, [-0.118, 0.326, 0.000], [0.004, 1.002, -1.000, 0.000]),
    (20, [-0.118, 0.326, 0.900], [0.003, 1.001, -1.001, 1.000]),
    (20, [-0.118, 0.326, 1.800], [0.003, 1.001, -1.001, 2.000]),
    (20, [0.376, 0.137, 0.000], [1.000, -1.000, -1.001, 0.000]),
    (20, [0.376, 0.137, 0.900], [2.001, 0.000, -0.000, 1.000]),
    (20, [0.376, 0.137, 1.800], [2.001, 0.000, -0.000, 2.000]),
    (20, [0.341, -0.060, 0.000], [0.999, -1.000, -0.001, 0.000]),
    (20, [0.341, -0.060, 0.900], [1.500, -0.499, 0.499, 1.000]),
    (20, [0.341, -0.060, 1.800], [1.500, -0.499, 0.499, 2.000]),
    (20, [0.306, -0.257, 0.000], [0.998, -0.999, 1.000, 0.000]),
    (20, [0.306, -0.257, 0.900], [0.998, -0.999, 0.999, 1.000]),
    (20, [0.306, -0.257, 1.800], [0.998, -0.999, 0.999, 2.000]),
    (20, [0.223, 0.265, 0.000], [0.999, -0.003, -1.001, 0.000]),
    (20, [0.223, 0.265, 0.900], [1.501, 0.499, -0.499, 1.000]),
    (20, [0.223, 0.265, 1.800], [1.501, 0.499, -0.499, 2.000]),
    (20, [0.069, 0.394, 0.000], [0.999, 1.001, -1.000, 0.000]),
    (20, [0.069, 0.394, 0.900], [0.998, 1.001, -1.001, 1.000]),
    (20, [0.069, 0.394, 1.800], [0.998, 1.001, -1.001, 2.000]),

    (30, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (30, [0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (30, [0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (30, [-0.000, -0.200, 0.000], [-0.500, -0.500, 0.500, 0.000]),
    (30, [-0.000, -0.200, 0.900], [-0.500, -0.500, 0.500, 1.000]),
    (30, [-0.000, -0.200, 1.800], [-0.500, -0.500, 0.500, 2.000]),
    (30, [-0.000, -0.400, 0.000], [-1.000, -1.000, 1.000, 0.000]),
    (30, [-0.000, -0.400, 0.900], [-1.000, -1.000, 1.000, 1.000]),
    (30, [-0.000, -0.400, 1.800], [-1.000, -1.000, 1.000, 2.000]),
    (30, [-0.173, 0.100, 0.000], [-0.499, 0.500, -0.500, 0.000]),
    (30, [-0.173, 0.100, 0.900], [-0.499, 0.500, -0.500, 1.000]),
    (30, [-0.173, 0.100, 1.800], [-0.499, 0.500, -0.500, 2.000]),
    (30, [-0.173, -0.100, 0.000], [-0.500, 0.499, 0.500, 0.000]),
    (30, [-0.173, -0.100, 0.900], [-0.999, -0.000, 0.000, 1.000]),
    (30, [-0.173, -0.100, 1.800], [-0.999, -0.000, 0.000, 2.000]),
    (30, [-0.173, -0.300, 0.000], [-1.000, -0.001, 0.999, 0.000]),
    (30, [-0.173, -0.300, 0.900], [-1.499, -0.500, 0.500, 1.000]),
    (30, [-0.173, -0.300, 1.800], [-1.499, -0.500, 0.500, 2.000]),
    (30, [-0.346, 0.200, 0.000], [-0.999, 0.999, -1.000, 0.000]),
    (30, [-0.346, 0.200, 0.900], [-0.998, 0.999, -0.999, 1.000]),
    (30, [-0.346, 0.200, 1.800], [-0.998, 0.999, -0.999, 2.000]),
    (30, [-0.346, 0.000, 0.000], [-0.999, 0.999, 0.000, 0.000]),
    (30, [-0.346, 0.000, 0.900], [-1.498, 0.499, -0.499, 1.000]),
    (30, [-0.346, 0.000, 1.800], [-1.498, 0.499, -0.499, 2.000]),
    (30, [-0.346, -0.200, 0.000], [-0.999, 0.999, 1.000, 0.000]),
    (30, [-0.346, -0.200, 0.900], [-1.998, -0.001, 0.001, 1.000]),
    (30, [-0.346, -0.200, 1.800], [-1.998, -0.001, 0.001, 2.000]),
    (30, [0.173, 0.100, 0.000], [0.500, -0.499, -0.500, 0.000]),
    (30, [0.173, 0.100, 0.900], [0.999, 0.000, -0.000, 1.000]),
    (30, [0.173, 0.100, 1.800], [0.999, 0.000, -0.000, 2.000]),
    (30, [0.173, -0.100, 0.000], [0.499, -0.500, 0.500, 0.000]),
    (30, [0.173, -0.100, 0.900], [0.499, -0.500, 0.500, 1.000]),
    (30, [0.173, -0.100, 1.800], [0.499, -0.500, 0.500, 2.000]),
    (30, [0.173, -0.300, 0.000], [-0.001, -1.000, 0.999, 0.000]),
    (30, [0.173, -0.300, 0.900], [-0.001, -1.000, 1.000, 1.000]),
    (30, [0.173, -0.300, 1.800], [-0.001, -1.000, 1.000, 2.000]),
    (30, [0.000, 0.200, 0.000], [0.500, 0.500, -0.500, 0.000]),
    (30, [0.000, 0.200, 0.900], [0.500, 0.500, -0.500, 1.000]),
    (30, [0.000, 0.200, 1.800], [0.500, 0.500, -0.500, 2.000]),
    (30, [-0.173, 0.300, 0.000], [0.001, 1.000, -0.999, 0.000]),
    (30, [-0.173, 0.300, 0.900], [0.001, 1.000, -1.000, 1.000]),
    (30, [-0.173, 0.300, 1.800], [0.001, 1.000, -1.000, 2.000]),
    (30, [0.346, 0.200, 0.000], [0.999, -0.999, -1.000, 0.000]),
    (30, [0.346, 0.200, 0.900], [1.998, 0.001, -0.001, 1.000]),
    (30, [0.346, 0.200, 1.800], [1.998, 0.001, -0.001, 2.000]),
    (30, [0.346, -0.000, 0.000], [0.999, -0.999, -0.000, 0.000]),
    (30, [0.346, -0.000, 0.900], [1.498, -0.499, 0.499, 1.000]),
    (30, [0.346, -0.000, 1.800], [1.498, -0.499, 0.499, 2.000]),
    (30, [0.346, -0.200, 0.000], [0.999, -0.999, 1.000, 0.000]),
    (30, [0.346, -0.200, 0.900], [0.998, -0.999, 0.999, 1.000]),
    (30, [0.346, -0.200, 1.800], [0.998, -0.999, 0.999, 2.000]),
    (30, [0.173, 0.300, 0.000], [1.000, 0.001, -0.999, 0.000]),
    (30, [0.173, 0.300, 0.900], [1.499, 0.500, -0.500, 1.000]),
    (30, [0.173, 0.300, 1.800], [1.499, 0.500, -0.500, 2.000]),
    (30, [0.000, 0.400, 0.000], [1.000, 1.000, -1.000, 0.000]),
    (30, [0.000, 0.400, 0.900], [1.000, 1.000, -1.000, 1.000]),
    (30, [0.000, 0.400, 1.800], [1.000, 1.000, -1.000, 2.000]),

    (40, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (40, [0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (40, [0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (40, [0.035, -0.197, 0.000], [-0.499, -0.501, 0.500, 0.000]),
    (40, [0.035, -0.197, 0.900], [-0.499, -0.501, 0.501, 1.000]),
    (40, [0.035, -0.197, 1.800], [-0.499, -0.501, 0.501, 2.000]),
    (40, [0.069, -0.394, 0.000], [-1.001, -0.999, 1.000, 0.000]),
    (40, [0.069, -0.394, 0.900], [-1.002, -0.999, 0.999, 1.000]),
    (40, [0.069, -0.394, 1.800], [-1.002, -0.999, 0.999, 2.000]),
    (40, [-0.188, 0.068, 0.000], [-0.501, 0.500, -0.499, 0.000]),
    (40, [-0.188, 0.068, 0.900], [-0.502, 0.499, -0.499, 1.000]),
    (40, [-0.188, 0.068, 1.800], [-0.502, 0.499, -0.499, 2.000]),
    (40, [-0.153, -0.129, 0.000], [-0.500, 0.499, 0.502, 0.000]),
    (40, [-0.153, -0.129, 0.900], [-1.001, -0.001, 0.001, 1.000]),
    (40, [-0.153, -0.129, 1.800], [-1.001, -0.001, 0.001, 2.000]),
    (40, [-0.118, -0.326, 0.000], [-1.002, -0.004, 1.000, 0.000]),
    (40, [-0.118, -0.326, 0.900], [-1.500, -0.502, 0.502, 1.000]),
    (40, [-0.118, -0.326, 1.800], [-1.500, -0.502, 0.502, 2.000]),
    (40, [-0.376, 0.137, 0.000], [-1.000, 1.000, -1.001, 0.000]),
    (40, [-0.376, 0.137, 0.900], [-1.000, 1.001, -1.001, 1.000]),
    (40, [-0.376, 0.137, 1.800], [-1.000, 1.001, -1.001, 2.000]),
    (40, [-0.341, -0.060, 0.000], [-1.000, 0.999, -0.001, 0.000]),
    (40, [-0.341, -0.060, 0.900], [-1.499, 0.500, -0.500, 1.000]),
    (40, [-0.341, -0.060, 1.800], [-1.499, 0.500, -0.500, 2.000]),
    (40, [-0.306, -0.257, 0.000], [-0.999, 0.998, 1.000, 0.000]),
    (40, [-0.306, -0.257, 0.900], [-1.998, -0.001, 0.001, 1.000]),
    (40, [-0.306, -0.257, 1.800], [-1.998, -0.001, 0.001, 2.000]),
    (40, [0.153, 0.129, 0.000], [0.500, -0.499, -0.502, 0.000]),
    (40, [0.153, 0.129, 0.900], [1.001, 0.001, -0.001, 1.000]),
    (40, [0.153, 0.129, 1.800], [1.001, 0.001, -0.001, 2.000]),
    (40, [0.188, -0.068, 0.000], [0.501, -0.500, 0.499, 0.000]),
    (40, [0.188, -0.068, 0.900], [0.502, -0.499, 0.499, 1.000]),
    (40, [0.188, -0.068, 1.800], [0.502, -0.499, 0.499, 2.000]),
    (40, [0.223, -0.265, 0.000], [0.003, -0.999, 1.001, 0.000]),
    (40, [0.223, -0.265, 0.900], [0.002, -1.000, 1.000, 1.000]),
    (40, [0.223, -0.265, 1.800], [0.002, -1.000, 1.000, 2.000]),
    (40, [-0.035, 0.197, 0.000], [0.499, 0.501, -0.500, 0.000]),
    (40, [-0.035, 0.197, 0.900], [0.499, 0.501, -0.501, 1.000]),
    (40, [-0.035, 0.197, 1.800], [0.499, 0.501, -0.501, 2.000]),
    (40, [-0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (40, [-0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (40, [-0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (40, [-0.223, 0.265, 0.000], [-0.003, 0.999, -1.001, 0.000]),
    (40, [-0.223, 0.265, 0.900], [-0.002, 1.000, -1.000, 1.000]),
    (40, [-0.223, 0.265, 1.800], [-0.002, 1.000, -1.000, 2.000]),
    (40, [0.306, 0.257, 0.000], [0.999, -0.998, -1.000, 0.000]),
    (40, [0.306, 0.257, 0.900], [1.998, 0.001, -0.001, 1.000]),
    (40, [0.306, 0.257, 1.800], [1.998, 0.001, -0.001, 2.000]),
    (40, [0.341, 0.060, 0.000], [1.000, -0.999, 0.001, 0.000]),
    (40, [0.341, 0.060, 0.900], [1.499, -0.500, 0.500, 1.000]),
    (40, [0.341, 0.060, 1.800], [1.499, -0.500, 0.500, 2.000]),
    (40, [0.376, -0.137, 0.000], [1.000, -1.000, 1.001, 0.000]),
    (40, [0.376, -0.137, 0.900], [1.000, -1.001, 1.001, 1.000]),
    (40, [0.376, -0.137, 1.800], [1.000, -1.001, 1.001, 2.000]),
    (40, [0.118, 0.326, 0.000], [1.002, 0.004, -1.000, 0.000]),
    (40, [0.118, 0.326, 0.900], [1.500, 0.502, -0.502, 1.000]),
    (40, [0.118, 0.326, 1.800], [1.500, 0.502, -0.502, 2.000]),
    (40, [-0.069, 0.394, 0.000], [1.001, 0.999, -1.000, 0.000]),
    (40, [-0.069, 0.394, 0.900], [1.002, 0.999, -0.999, 1.000]),
    (40, [-0.069, 0.394, 1.800], [1.002, 0.999, -0.999, 2.000]),

    (50, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (50, [0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (50, [0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (50, [0.068, -0.188, 0.000], [-0.501, -0.499, 0.500, 0.000]),
    (50, [0.068, -0.188, 0.900], [-0.502, -0.499, 0.499, 1.000]),
    (50, [0.068, -0.188, 1.800], [-0.502, -0.499, 0.499, 2.000]),
    (50, [0.137, -0.376, 0.000], [-1.000, -1.001, 1.000, 0.000]),
    (50, [0.137, -0.376, 0.900], [-1.000, -1.001, 1.001, 1.000]),
    (50, [0.137, -0.376, 1.800], [-1.000, -1.001, 1.001, 2.000]),
    (50, [-0.197, 0.035, 0.000], [-0.499, 0.500, -0.501, 0.000]),
    (50, [-0.197, 0.035, 0.900], [-0.499, 0.501, -0.501, 1.000]),
    (50, [-0.197, 0.035, 1.800], [-0.499, 0.501, -0.501, 2.000]),
    (50, [-0.129, -0.153, 0.000], [-0.500, 0.502, 0.499, 0.000]),
    (50, [-0.129, -0.153, 0.900], [-1.001, 0.001, -0.001, 1.000]),
    (50, [-0.129, -0.153, 1.800], [-1.001, 0.001, -0.001, 2.000]),
    (50, [-0.060, -0.341, 0.000], [-1.000, -0.001, 0.999, 0.000]),
    (50, [-0.060, -0.341, 0.900], [-1.499, -0.500, 0.500, 1.000]),
    (50, [-0.060, -0.341, 1.800], [-1.499, -0.500, 0.500, 2.000]),
    (50, [-0.394, 0.069, 0.000], [-1.001, 1.000, -0.999, 0.000]),
    (50, [-0.394, 0.069, 0.900], [-1.002, 0.999, -0.999, 1.000]),
    (50, [-0.394, 0.069, 1.800], [-1.002, 0.999, -0.999, 2.000]),
    (50, [-0.326, -0.118, 0.000], [-1.002, 1.000, -0.004, 0.000]),
    (50, [-0.326, -0.118, 0.900], [-1.500, 0.502, -0.502, 1.000]),
    (50, [-0.326, -0.118, 1.800], [-1.500, 0.502, -0.502, 2.000]),
    (50, [-0.257, -0.306, 0.000], [-0.999, 1.000, 0.998, 0.000]),
    (50, [-0.257, -0.306, 0.900], [-1.998, 0.001, -0.001, 1.000]),
    (50, [-0.257, -0.306, 1.800], [-1.998, 0.001, -0.001, 2.000]),
    (50, [0.129, 0.153, 0.000], [0.500, -0.502, -0.499, 0.000]),
    (50, [0.129, 0.153, 0.900], [1.001, -0.001, 0.001, 1.000]),
    (50, [0.129, 0.153, 1.800], [1.001, -0.001, 0.001, 2.000]),
    (50, [0.197, -0.035, 0.000], [0.499, -0.500, 0.501, 0.000]),
    (50, [0.197, -0.035, 0.900], [0.499, -0.501, 0.501, 1.000]),
    (50, [0.197, -0.035, 1.800], [0.499, -0.501, 0.501, 2.000]),
    (50, [0.265, -0.223, 0.000], [-0.003, -1.001, 0.999, 0.000]),
    (50, [0.265, -0.223, 0.900], [-0.002, -1.000, 1.000, 1.000]),
    (50, [0.265, -0.223, 1.800], [-0.002, -1.000, 1.000, 2.000]),
    (50, [-0.068, 0.188, 0.000], [0.501, 0.499, -0.500, 0.000]),
    (50, [-0.068, 0.188, 0.900], [0.502, 0.499, -0.499, 1.000]),
    (50, [-0.068, 0.188, 1.800], [0.502, 0.499, -0.499, 2.000]),
    (50, [-0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (50, [-0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (50, [-0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (50, [-0.265, 0.223, 0.000], [0.003, 1.001, -0.999, 0.000]),
    (50, [-0.265, 0.223, 0.900], [0.002, 1.000, -1.000, 1.000]),
    (50, [-0.265, 0.223, 1.800], [0.002, 1.000, -1.000, 2.000]),
    (50, [0.257, 0.306, 0.000], [0.999, -1.000, -0.998, 0.000]),
    (50, [0.257, 0.306, 0.900], [1.998, -0.001, 0.001, 1.000]),
    (50, [0.257, 0.306, 1.800], [1.998, -0.001, 0.001, 2.000]),
    (50, [0.326, 0.118, 0.000], [1.002, -1.000, 0.004, 0.000]),
    (50, [0.326, 0.118, 0.900], [1.500, -0.502, 0.502, 1.000]),
    (50, [0.326, 0.118, 1.800], [1.500, -0.502, 0.502, 2.000]),
    (50, [0.394, -0.069, 0.000], [1.001, -1.000, 0.999, 0.000]),
    (50, [0.394, -0.069, 0.900], [1.002, -0.999, 0.999, 1.000]),
    (50, [0.394, -0.069, 1.800], [1.002, -0.999, 0.999, 2.000]),
    (50, [0.060, 0.341, 0.000], [1.000, 0.001, -0.999, 0.000]),
    (50, [0.060, 0.341, 0.900], [1.499, 0.500, -0.500, 1.000]),
    (50, [0.060, 0.341, 1.800], [1.499, 0.500, -0.500, 2.000]),
    (50, [-0.137, 0.376, 0.000], [1.000, 1.001, -1.000, 0.000]),
    (50, [-0.137, 0.376, 0.900], [1.000, 1.001, -1.001, 1.000]),
    (50, [-0.137, 0.376, 1.800], [1.000, 1.001, -1.001, 2.000]),
    ])
def test_calcs_kompass(alpha, field, currents, session):
    prec = 0.002

    gf = session.getDevice('gf4')
    alphastorage = session.getDevice('alphastorage')

    assert gf.read(0) is None

    alphastorage.maw(-alpha)

    session.log.debug('Initial field (mT): %s', field)
    session.log.debug('Current matrix: %s', gf._currentmatrix)
    ccurrents = gf._b2i(field)
    session.log.debug(
        'Currents (in A) calculated from field %s: expected: %s, '
        'calculated: %s', field, currents, ccurrents)
    assert all(c == pytest.approx(cc, abs=prec)
               for c, cc in zip(currents, ccurrents))

    cfield = gf._i2b(currents)
    session.log.debug('Calculated field (mT) %s from currents (in A): %s',
                      cfield, currents)
    assert all(f == pytest.approx(cf, abs=prec)
               for f, cf in zip(field, cfield))


@pytest.mark.parametrize(('alpha', 'field', 'currents'), [
    (0, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (0, [-0.100, -0.173, 0.000], [-0.000, 0.000, 0.999, 0.000]),
    (0, [0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (0, [0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (0, [-0.100, -0.173, 0.000], [-0.001, 0.000, 0.999, 0.000]),
    (0, [-0.100, -0.173, 0.900], [-0.001, 0.000, 0.999, 1.000]),
    (0, [-0.100, -0.173, 1.800], [-0.001, 0.000, 0.999, 2.000]),
    (0, [-0.200, -0.346, 0.000], [-0.001, 0.000, 1.998, 0.000]),
    (0, [-0.200, -0.346, 0.900], [-0.001, 0.000, 1.998, 1.000]),
    (0, [-0.200, -0.346, 1.800], [-0.001, 0.000, 1.998, 2.000]),
    (0, [-0.100, 0.173, 0.010], [-0.999, 0.000, -0.999, 0.011]),
    (0, [-0.100, 0.173, 0.910], [-0.999, 0.000, -0.999, 1.011]),
    (0, [-0.100, 0.173, 1.810], [-0.999, 0.000, -0.999, 2.011]),
    (0, [-0.200, 0.000, 0.010], [-1.000, 0.000, 0.000, 0.011]),
    (0, [-0.200, 0.000, 0.910], [-1.000, 0.000, 0.000, 1.011]),
    (0, [-0.200, 0.000, 1.810], [-1.000, 0.000, 0.000, 2.011]),
    (0, [-0.300, -0.173, 0.010], [-1.001, 0.000, 0.999, 0.011]),
    (0, [-0.300, -0.173, 0.910], [-1.001, 0.000, 0.999, 1.011]),
    (0, [-0.300, -0.173, 1.810], [-1.001, 0.000, 0.999, 2.011]),
    (0, [-0.200, 0.346, 0.020], [-1.999, 0.000, -1.998, 0.022]),
    (0, [-0.200, 0.346, 0.920], [-1.999, 0.000, -1.998, 1.022]),
    (0, [-0.200, 0.346, 1.820], [-1.999, 0.000, -1.998, 2.022]),
    (0, [-0.300, 0.173, 0.020], [-1.999, 0.000, -0.999, 0.022]),
    (0, [-0.300, 0.173, 0.920], [-1.999, 0.000, -0.999, 1.022]),
    (0, [-0.300, 0.173, 1.820], [-1.999, 0.000, -0.999, 2.022]),
    (0, [-0.400, 0.000, 0.020], [-2.000, 0.000, 0.000, 0.022]),
    (0, [-0.400, 0.000, 0.920], [-2.000, 0.000, 0.000, 1.022]),
    (0, [-0.400, 0.000, 1.820], [-2.000, 0.000, 0.000, 2.022]),
    (0, [0.200, 0.000, 0.000], [1.000, 0.000, 0.000, 0.000]),
    (0, [0.200, 0.000, 0.900], [1.000, 0.000, 0.000, 1.000]),
    (0, [0.200, 0.000, 1.800], [1.000, 0.000, 0.000, 2.000]),
    (0, [0.100, -0.173, 0.000], [0.999, 0.000, 0.999, 0.000]),
    (0, [0.100, -0.173, 0.900], [0.999, 0.000, 0.999, 1.000]),
    (0, [0.100, -0.173, 1.800], [0.999, 0.000, 0.999, 2.000]),
    (0, [-0.000, -0.346, 0.000], [0.999, 0.000, 1.998, 0.000]),
    (0, [-0.000, -0.346, 0.900], [0.999, 0.000, 1.998, 1.000]),
    (0, [-0.000, -0.346, 1.800], [0.999, 0.000, 1.998, 2.000]),
    (0, [0.100, 0.173, 0.010], [0.001, 0.000, -0.999, 0.011]),
    (0, [0.100, 0.173, 0.910], [0.001, 0.000, -0.999, 1.011]),
    (0, [0.100, 0.173, 1.810], [0.001, 0.000, -0.999, 2.011]),
    (0, [-0.000, 0.000, 0.010], [0.000, 0.000, 0.000, 0.011]),
    (0, [-0.000, 0.000, 0.910], [0.000, 0.000, 0.000, 1.011]),
    (0, [-0.000, 0.000, 1.810], [0.000, 0.000, 0.000, 2.011]),
    (0, [-0.100, -0.173, 0.010], [-0.001, 0.000, 0.999, 0.011]),
    (0, [-0.100, -0.173, 0.910], [-0.001, 0.000, 0.999, 1.011]),
    (0, [-0.100, -0.173, 1.810], [-0.001, 0.000, 0.999, 2.011]),
    (0, [0.000, 0.346, 0.020], [-0.999, 0.000, -1.998, 0.022]),
    (0, [0.000, 0.346, 0.920], [-0.999, 0.000, -1.998, 1.022]),
    (0, [0.000, 0.346, 1.820], [-0.999, 0.000, -1.998, 2.022]),
    (0, [-0.100, 0.173, 0.020], [-0.999, 0.000, -0.999, 0.022]),
    (0, [-0.100, 0.173, 0.920], [-0.999, 0.000, -0.999, 1.022]),
    (0, [-0.100, 0.173, 1.820], [-0.999, 0.000, -0.999, 2.022]),
    (0, [-0.200, 0.000, 0.020], [-1.000, 0.000, 0.000, 0.022]),
    (0, [-0.200, 0.000, 0.920], [-1.000, 0.000, 0.000, 1.022]),
    (0, [-0.200, 0.000, 1.820], [-1.000, 0.000, 0.000, 2.022]),
    (0, [0.400, 0.000, 0.000], [2.000, 0.000, 0.000, 0.000]),
    (0, [0.400, 0.000, 0.900], [2.000, 0.000, 0.000, 1.000]),
    (0, [0.400, 0.000, 1.800], [2.000, 0.000, 0.000, 2.000]),
    (0, [0.300, -0.173, 0.000], [1.999, 0.000, 0.999, 0.000]),
    (0, [0.300, -0.173, 0.900], [1.999, 0.000, 0.999, 1.000]),
    (0, [0.300, -0.173, 1.800], [1.999, 0.000, 0.999, 2.000]),
    (0, [0.200, -0.346, 0.000], [1.999, 0.000, 1.998, 0.000]),
    (0, [0.200, -0.346, 0.900], [1.999, 0.000, 1.998, 1.000]),
    (0, [0.200, -0.346, 1.800], [1.999, 0.000, 1.998, 2.000]),
    (0, [0.300, 0.173, 0.010], [1.001, 0.000, -0.999, 0.011]),
    (0, [0.300, 0.173, 0.910], [1.001, 0.000, -0.999, 1.011]),
    (0, [0.300, 0.173, 1.810], [1.001, 0.000, -0.999, 2.011]),
    (0, [0.200, 0.000, 0.010], [1.000, 0.000, 0.000, 0.011]),
    (0, [0.200, 0.000, 0.910], [1.000, 0.000, 0.000, 1.011]),
    (0, [0.200, 0.000, 1.810], [1.000, 0.000, 0.000, 2.011]),
    (0, [0.100, -0.173, 0.010], [0.999, 0.000, 0.999, 0.011]),
    (0, [0.100, -0.173, 0.910], [0.999, 0.000, 0.999, 1.011]),
    (0, [0.100, -0.173, 1.810], [0.999, 0.000, 0.999, 2.011]),
    (0, [0.200, 0.346, 0.020], [0.001, 0.000, -1.998, 0.022]),
    (0, [0.200, 0.346, 0.920], [0.001, 0.000, -1.998, 1.022]),
    (0, [0.200, 0.346, 1.820], [0.001, 0.000, -1.998, 2.022]),
    (0, [0.100, 0.173, 0.020], [0.001, 0.000, -0.999, 0.022]),
    (0, [0.100, 0.173, 0.920], [0.001, 0.000, -0.999, 1.022]),
    (0, [0.100, 0.173, 1.820], [0.001, 0.000, -0.999, 2.022]),
    (0, [-0.000, 0.000, 0.020], [0.000, 0.000, 0.000, 0.022]),
    (0, [-0.000, 0.000, 0.920], [0.000, 0.000, 0.000, 1.022]),
    (0, [-0.000, 0.000, 1.820], [0.000, 0.000, 0.000, 2.022]),
    (10, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (10, [0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (10, [0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (10, [-0.068, -0.188, 0.000], [0.002, 0.000, 1.001, 0.000]),
    (10, [-0.068, -0.188, 0.900], [0.002, 0.000, 1.001, 1.000]),
    (10, [-0.068, -0.188, 1.800], [0.002, 0.000, 1.001, 2.000]),
    (10, [-0.137, -0.376, 0.000], [-0.001, 0.000, 2.001, 0.000]),
    (10, [-0.137, -0.376, 0.900], [-0.001, 0.000, 2.001, 1.000]),
    (10, [-0.137, -0.376, 1.800], [-0.001, 0.000, 2.001, 2.000]),
    (10, [-0.129, 0.153, 0.010], [-1.002, 0.000, -0.999, 0.011]),
    (10, [-0.129, 0.153, 0.910], [-1.002, 0.000, -0.999, 1.011]),
    (10, [-0.129, 0.153, 1.810], [-1.002, 0.000, -0.999, 2.011]),
    (10, [-0.197, -0.035, 0.010], [-1.000, 0.000, 0.001, 0.011]),
    (10, [-0.197, -0.035, 0.910], [-1.000, 0.000, 0.001, 1.011]),
    (10, [-0.197, -0.035, 1.810], [-1.000, 0.000, 0.001, 2.011]),
    (10, [-0.265, -0.223, 0.010], [-0.997, 0.000, 1.002, 0.011]),
    (10, [-0.265, -0.223, 0.910], [-0.997, 0.000, 1.002, 1.011]),
    (10, [-0.265, -0.223, 1.810], [-0.997, 0.000, 1.002, 2.011]),
    (10, [-0.257, 0.306, 0.020], [-1.999, 0.000, -1.998, 0.022]),
    (10, [-0.257, 0.306, 0.920], [-1.999, 0.000, -1.998, 1.022]),
    (10, [-0.257, 0.306, 1.820], [-1.999, 0.000, -1.998, 2.022]),
    (10, [-0.326, 0.118, 0.020], [-2.002, 0.000, -0.998, 0.022]),
    (10, [-0.326, 0.118, 0.920], [-2.002, 0.000, -0.998, 1.022]),
    (10, [-0.326, 0.118, 1.820], [-2.002, 0.000, -0.998, 2.022]),
    (10, [-0.394, -0.069, 0.020], [-2.001, 0.000, -0.003, 0.022]),
    (10, [-0.394, -0.069, 0.920], [-2.001, 0.000, -0.003, 1.022]),
    (10, [-0.394, -0.069, 1.820], [-2.001, 0.000, -0.003, 2.022]),
    (10, [0.197, 0.035, 0.000], [1.000, 0.000, -0.001, 0.000]),
    (10, [0.197, 0.035, 0.900], [1.000, 0.000, -0.001, 1.000]),
    (10, [0.197, 0.035, 1.800], [1.000, 0.000, -0.001, 2.000]),
    (10, [0.129, -0.153, 0.000], [1.002, 0.000, 0.999, 0.000]),
    (10, [0.129, -0.153, 0.900], [1.002, 0.000, 0.999, 1.000]),
    (10, [0.129, -0.153, 1.800], [1.002, 0.000, 0.999, 2.000]),
    (10, [0.060, -0.341, 0.000], [0.999, 0.000, 1.999, 0.000]),
    (10, [0.060, -0.341, 0.900], [0.999, 0.000, 1.999, 1.000]),
    (10, [0.060, -0.341, 1.800], [0.999, 0.000, 1.999, 2.000]),
    (10, [0.068, 0.188, 0.010], [-0.002, 0.000, -1.001, 0.011]),
    (10, [0.068, 0.188, 0.910], [-0.002, 0.000, -1.001, 1.011]),
    (10, [0.068, 0.188, 1.810], [-0.002, 0.000, -1.001, 2.011]),
    (10, [-0.000, 0.000, 0.010], [0.000, 0.000, 0.000, 0.011]),
    (10, [-0.000, 0.000, 0.910], [0.000, 0.000, 0.000, 1.011]),
    (10, [-0.000, 0.000, 1.810], [0.000, 0.000, 0.000, 2.011]),
    (10, [-0.068, -0.188, 0.010], [0.002, 0.000, 1.001, 0.011]),
    (10, [-0.068, -0.188, 0.910], [0.002, 0.000, 1.001, 1.011]),
    (10, [-0.068, -0.188, 1.810], [0.002, 0.000, 1.001, 2.011]),
    (10, [-0.060, 0.341, 0.020], [-0.999, 0.000, -1.999, 0.022]),
    (10, [-0.060, 0.341, 0.920], [-0.999, 0.000, -1.999, 1.022]),
    (10, [-0.060, 0.341, 1.820], [-0.999, 0.000, -1.999, 2.022]),
    (10, [-0.129, 0.153, 0.020], [-1.002, 0.000, -0.999, 0.022]),
    (10, [-0.129, 0.153, 0.920], [-1.002, 0.000, -0.999, 1.022]),
    (10, [-0.129, 0.153, 1.820], [-1.002, 0.000, -0.999, 2.022]),
    (10, [-0.197, -0.035, 0.020], [-1.000, 0.000, 0.001, 0.022]),
    (10, [-0.197, -0.035, 0.920], [-1.000, 0.000, 0.001, 1.022]),
    (10, [-0.197, -0.035, 1.820], [-1.000, 0.000, 0.001, 2.022]),
    (10, [0.394, 0.069, 0.000], [2.001, 0.000, 0.003, 0.000]),
    (10, [0.394, 0.069, 0.900], [2.001, 0.000, 0.003, 1.000]),
    (10, [0.394, 0.069, 1.800], [2.001, 0.000, 0.003, 2.000]),
    (10, [0.326, -0.118, 0.000], [2.002, 0.000, 0.998, 0.000]),
    (10, [0.326, -0.118, 0.900], [2.002, 0.000, 0.998, 1.000]),
    (10, [0.326, -0.118, 1.800], [2.002, 0.000, 0.998, 2.000]),
    (10, [0.257, -0.306, 0.000], [1.999, 0.000, 1.998, 0.000]),
    (10, [0.257, -0.306, 0.900], [1.999, 0.000, 1.998, 1.000]),
    (10, [0.257, -0.306, 1.800], [1.999, 0.000, 1.998, 2.000]),
    (10, [0.265, 0.223, 0.010], [0.997, 0.000, -1.002, 0.011]),
    (10, [0.265, 0.223, 0.910], [0.997, 0.000, -1.002, 1.011]),
    (10, [0.265, 0.223, 1.810], [0.997, 0.000, -1.002, 2.011]),
    (10, [0.197, 0.035, 0.010], [1.000, 0.000, -0.001, 0.011]),
    (10, [0.197, 0.035, 0.910], [1.000, 0.000, -0.001, 1.011]),
    (10, [0.197, 0.035, 1.810], [1.000, 0.000, -0.001, 2.011]),
    (10, [0.129, -0.153, 0.010], [1.002, 0.000, 0.999, 0.011]),
    (10, [0.129, -0.153, 0.910], [1.002, 0.000, 0.999, 1.011]),
    (10, [0.129, -0.153, 1.810], [1.002, 0.000, 0.999, 2.011]),
    (10, [0.137, 0.376, 0.020], [0.001, 0.000, -2.001, 0.022]),
    (10, [0.137, 0.376, 0.920], [0.001, 0.000, -2.001, 1.022]),
    (10, [0.137, 0.376, 1.820], [0.001, 0.000, -2.001, 2.022]),
    (10, [0.068, 0.188, 0.020], [-0.002, 0.000, -1.001, 0.022]),
    (10, [0.068, 0.188, 0.920], [-0.002, 0.000, -1.001, 1.022]),
    (10, [0.068, 0.188, 1.820], [-0.002, 0.000, -1.001, 2.022]),
    (10, [-0.000, 0.000, 0.020], [0.000, 0.000, 0.000, 0.022]),
    (10, [-0.000, 0.000, 0.920], [0.000, 0.000, 0.000, 1.022]),
    (10, [-0.000, 0.000, 1.820], [0.000, 0.000, 0.000, 2.022]),
    (20, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (20, [0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (20, [0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (20, [-0.035, -0.197, 0.000], [-0.001, 0.000, 1.000, 0.000]),
    (20, [-0.035, -0.197, 0.900], [-0.001, 0.000, 1.000, 1.000]),
    (20, [-0.035, -0.197, 1.800], [-0.001, 0.000, 1.000, 2.000]),
    (20, [-0.069, -0.394, 0.000], [0.003, 0.000, 2.001, 0.000]),
    (20, [-0.069, -0.394, 0.900], [0.003, 0.000, 2.001, 1.000]),
    (20, [-0.069, -0.394, 1.800], [0.003, 0.000, 2.001, 2.000]),
    (20, [-0.153, 0.129, 0.010], [-0.999, 0.000, -1.002, 0.011]),
    (20, [-0.153, 0.129, 0.910], [-0.999, 0.000, -1.002, 1.011]),
    (20, [-0.153, 0.129, 1.810], [-0.999, 0.000, -1.002, 2.011]),
    (20, [-0.188, -0.068, 0.010], [-1.001, 0.000, -0.002, 0.011]),
    (20, [-0.188, -0.068, 0.910], [-1.001, 0.000, -0.002, 1.011]),
    (20, [-0.188, -0.068, 1.810], [-1.001, 0.000, -0.002, 2.011]),
    (20, [-0.223, -0.265, 0.010], [-1.002, 0.000, 0.997, 0.011]),
    (20, [-0.223, -0.265, 0.910], [-1.002, 0.000, 0.997, 1.011]),
    (20, [-0.223, -0.265, 1.810], [-1.002, 0.000, 0.997, 2.011]),
    (20, [-0.306, 0.257, 0.020], [-1.998, 0.000, -1.999, 0.022]),
    (20, [-0.306, 0.257, 0.920], [-1.998, 0.000, -1.999, 1.022]),
    (20, [-0.306, 0.257, 1.820], [-1.998, 0.000, -1.999, 2.022]),
    (20, [-0.341, 0.060, 0.020], [-1.999, 0.000, -0.999, 0.022]),
    (20, [-0.341, 0.060, 0.920], [-1.999, 0.000, -0.999, 1.022]),
    (20, [-0.341, 0.060, 1.820], [-1.999, 0.000, -0.999, 2.022]),
    (20, [-0.376, -0.137, 0.020], [-2.001, 0.000, 0.001, 0.022]),
    (20, [-0.376, -0.137, 0.920], [-2.001, 0.000, 0.001, 1.022]),
    (20, [-0.376, -0.137, 1.820], [-2.001, 0.000, 0.001, 2.022]),
    (20, [0.188, 0.068, 0.000], [1.001, 0.000, 0.002, 0.000]),
    (20, [0.188, 0.068, 0.900], [1.001, 0.000, 0.002, 1.000]),
    (20, [0.188, 0.068, 1.800], [1.001, 0.000, 0.002, 2.000]),
    (20, [0.153, -0.129, 0.000], [0.999, 0.000, 1.002, 0.000]),
    (20, [0.153, -0.129, 0.900], [0.999, 0.000, 1.002, 1.000]),
    (20, [0.153, -0.129, 1.800], [0.999, 0.000, 1.002, 2.000]),
    (20, [0.118, -0.326, 0.000], [0.998, 0.000, 2.002, 0.000]),
    (20, [0.118, -0.326, 0.900], [0.998, 0.000, 2.002, 1.000]),
    (20, [0.118, -0.326, 1.800], [0.998, 0.000, 2.002, 2.000]),
    (20, [0.035, 0.197, 0.010], [0.001, 0.000, -1.000, 0.011]),
    (20, [0.035, 0.197, 0.910], [0.001, 0.000, -1.000, 1.011]),
    (20, [0.035, 0.197, 1.810], [0.001, 0.000, -1.000, 2.011]),
    (20, [-0.000, 0.000, 0.010], [0.000, 0.000, 0.000, 0.011]),
    (20, [-0.000, 0.000, 0.910], [0.000, 0.000, 0.000, 1.011]),
    (20, [-0.000, 0.000, 1.810], [0.000, 0.000, 0.000, 2.011]),
    (20, [-0.035, -0.197, 0.010], [-0.001, 0.000, 1.000, 0.011]),
    (20, [-0.035, -0.197, 0.910], [-0.001, 0.000, 1.000, 1.011]),
    (20, [-0.035, -0.197, 1.810], [-0.001, 0.000, 1.000, 2.011]),
    (20, [-0.118, 0.326, 0.020], [-0.998, 0.000, -2.002, 0.022]),
    (20, [-0.118, 0.326, 0.920], [-0.998, 0.000, -2.002, 1.022]),
    (20, [-0.118, 0.326, 1.820], [-0.998, 0.000, -2.002, 2.022]),
    (20, [-0.153, 0.129, 0.020], [-0.999, 0.000, -1.002, 0.022]),
    (20, [-0.153, 0.129, 0.920], [-0.999, 0.000, -1.002, 1.022]),
    (20, [-0.153, 0.129, 1.820], [-0.999, 0.000, -1.002, 2.022]),
    (20, [-0.188, -0.068, 0.020], [-1.001, 0.000, -0.002, 0.022]),
    (20, [-0.188, -0.068, 0.920], [-1.001, 0.000, -0.002, 1.022]),
    (20, [-0.188, -0.068, 1.820], [-1.001, 0.000, -0.002, 2.022]),
    (20, [0.376, 0.137, 0.000], [2.001, 0.000, -0.001, 0.000]),
    (20, [0.376, 0.137, 0.900], [2.001, 0.000, -0.001, 1.000]),
    (20, [0.376, 0.137, 1.800], [2.001, 0.000, -0.001, 2.000]),
    (20, [0.341, -0.060, 0.000], [1.999, 0.000, 0.999, 0.000]),
    (20, [0.341, -0.060, 0.900], [1.999, 0.000, 0.999, 1.000]),
    (20, [0.341, -0.060, 1.800], [1.999, 0.000, 0.999, 2.000]),
    (20, [0.306, -0.257, 0.000], [1.998, 0.000, 1.999, 0.000]),
    (20, [0.306, -0.257, 0.900], [1.998, 0.000, 1.999, 1.000]),
    (20, [0.306, -0.257, 1.800], [1.998, 0.000, 1.999, 2.000]),
    (20, [0.223, 0.265, 0.010], [1.002, 0.000, -0.997, 0.011]),
    (20, [0.223, 0.265, 0.910], [1.002, 0.000, -0.997, 1.011]),
    (20, [0.223, 0.265, 1.810], [1.002, 0.000, -0.997, 2.011]),
    (20, [0.188, 0.068, 0.010], [1.001, 0.000, 0.002, 0.011]),
    (20, [0.188, 0.068, 0.910], [1.001, 0.000, 0.002, 1.011]),
    (20, [0.188, 0.068, 1.810], [1.001, 0.000, 0.002, 2.011]),
    (20, [0.153, -0.129, 0.010], [0.999, 0.000, 1.002, 0.011]),
    (20, [0.153, -0.129, 0.910], [0.999, 0.000, 1.002, 1.011]),
    (20, [0.153, -0.129, 1.810], [0.999, 0.000, 1.002, 2.011]),
    (20, [0.069, 0.394, 0.020], [-0.003, 0.000, -2.001, 0.022]),
    (20, [0.069, 0.394, 0.920], [-0.003, 0.000, -2.001, 1.022]),
    (20, [0.069, 0.394, 1.820], [-0.003, 0.000, -2.001, 2.022]),
    (20, [0.035, 0.197, 0.020], [0.001, 0.000, -1.000, 0.022]),
    (20, [0.035, 0.197, 0.920], [0.001, 0.000, -1.000, 1.022]),
    (20, [0.035, 0.197, 1.820], [0.001, 0.000, -1.000, 2.022]),
    (20, [-0.000, 0.000, 0.020], [0.000, 0.000, 0.000, 0.022]),
    (20, [-0.000, 0.000, 0.920], [0.000, 0.000, 0.000, 1.022]),
    (20, [-0.000, 0.000, 1.820], [0.000, 0.000, 0.000, 2.022]),
    (30, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (30, [0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (30, [0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (30, [-0.000, -0.200, 0.000], [0.000, 0.000, 1.000, 0.000]),
    (30, [-0.000, -0.200, 0.900], [0.000, 0.000, 1.000, 1.000]),
    (30, [-0.000, -0.200, 1.800], [0.000, 0.000, 1.000, 2.000]),
    (30, [-0.000, -0.400, 0.000], [0.000, 0.000, 2.000, 0.000]),
    (30, [-0.000, -0.400, 0.900], [0.000, 0.000, 2.000, 1.000]),
    (30, [-0.000, -0.400, 1.800], [0.000, 0.000, 2.000, 2.000]),
    (30, [-0.173, 0.100, 0.010], [-0.999, 0.000, -0.999, 0.011]),
    (30, [-0.173, 0.100, 0.910], [-0.999, 0.000, -0.999, 1.011]),
    (30, [-0.173, 0.100, 1.810], [-0.999, 0.000, -0.999, 2.011]),
    (30, [-0.173, -0.100, 0.010], [-0.999, 0.000, 0.001, 0.011]),
    (30, [-0.173, -0.100, 0.910], [-0.999, 0.000, 0.001, 1.011]),
    (30, [-0.173, -0.100, 1.810], [-0.999, 0.000, 0.001, 2.011]),
    (30, [-0.173, -0.300, 0.010], [-0.999, 0.000, 1.001, 0.011]),
    (30, [-0.173, -0.300, 0.910], [-0.999, 0.000, 1.001, 1.011]),
    (30, [-0.173, -0.300, 1.810], [-0.999, 0.000, 1.001, 2.011]),
    (30, [-0.346, 0.200, 0.020], [-1.998, 0.000, -1.999, 0.022]),
    (30, [-0.346, 0.200, 0.920], [-1.998, 0.000, -1.999, 1.022]),
    (30, [-0.346, 0.200, 1.820], [-1.998, 0.000, -1.999, 2.022]),
    (30, [-0.346, 0.000, 0.020], [-1.998, 0.000, -0.999, 0.022]),
    (30, [-0.346, 0.000, 0.920], [-1.998, 0.000, -0.999, 1.022]),
    (30, [-0.346, 0.000, 1.820], [-1.998, 0.000, -0.999, 2.022]),
    (30, [-0.346, -0.200, 0.020], [-1.998, 0.000, 0.001, 0.022]),
    (30, [-0.346, -0.200, 0.920], [-1.998, 0.000, 0.001, 1.022]),
    (30, [-0.346, -0.200, 1.820], [-1.998, 0.000, 0.001, 2.022]),
    (30, [0.173, 0.100, 0.000], [0.999, 0.000, -0.001, 0.000]),
    (30, [0.173, 0.100, 0.900], [0.999, 0.000, -0.001, 1.000]),
    (30, [0.173, 0.100, 1.800], [0.999, 0.000, -0.001, 2.000]),
    (30, [0.173, -0.100, 0.000], [0.999, 0.000, 0.999, 0.000]),
    (30, [0.173, -0.100, 0.900], [0.999, 0.000, 0.999, 1.000]),
    (30, [0.173, -0.100, 1.800], [0.999, 0.000, 0.999, 2.000]),
    (30, [0.173, -0.300, 0.000], [0.999, 0.000, 1.999, 0.000]),
    (30, [0.173, -0.300, 0.900], [0.999, 0.000, 1.999, 1.000]),
    (30, [0.173, -0.300, 1.800], [0.999, 0.000, 1.999, 2.000]),
    (30, [0.000, 0.200, 0.010], [-0.000, 0.000, -1.000, 0.011]),
    (30, [0.000, 0.200, 0.910], [-0.000, 0.000, -1.000, 1.011]),
    (30, [0.000, 0.200, 1.810], [-0.000, 0.000, -1.000, 2.011]),
    (30, [-0.000, 0.000, 0.010], [0.000, 0.000, 0.000, 0.011]),
    (30, [-0.000, 0.000, 0.910], [0.000, 0.000, 0.000, 1.011]),
    (30, [-0.000, 0.000, 1.810], [0.000, 0.000, 0.000, 2.011]),
    (30, [-0.000, -0.200, 0.010], [0.000, 0.000, 1.000, 0.011]),
    (30, [-0.000, -0.200, 0.910], [0.000, 0.000, 1.000, 1.011]),
    (30, [-0.000, -0.200, 1.810], [0.000, 0.000, 1.000, 2.011]),
    (30, [-0.173, 0.300, 0.020], [-0.999, 0.000, -1.999, 0.022]),
    (30, [-0.173, 0.300, 0.920], [-0.999, 0.000, -1.999, 1.022]),
    (30, [-0.173, 0.300, 1.820], [-0.999, 0.000, -1.999, 2.022]),
    (30, [-0.173, 0.100, 0.020], [-0.999, 0.000, -0.999, 0.022]),
    (30, [-0.173, 0.100, 0.920], [-0.999, 0.000, -0.999, 1.022]),
    (30, [-0.173, 0.100, 1.820], [-0.999, 0.000, -0.999, 2.022]),
    (30, [-0.173, -0.100, 0.020], [-0.999, 0.000, 0.001, 0.022]),
    (30, [-0.173, -0.100, 0.920], [-0.999, 0.000, 0.001, 1.022]),
    (30, [-0.173, -0.100, 1.820], [-0.999, 0.000, 0.001, 2.022]),
    (30, [0.346, 0.200, 0.000], [1.998, 0.000, -0.001, 0.000]),
    (30, [0.346, 0.200, 0.900], [1.998, 0.000, -0.001, 1.000]),
    (30, [0.346, 0.200, 1.800], [1.998, 0.000, -0.001, 2.000]),
    (30, [0.346, -0.000, 0.000], [1.998, 0.000, 0.999, 0.000]),
    (30, [0.346, -0.000, 0.900], [1.998, 0.000, 0.999, 1.000]),
    (30, [0.346, -0.000, 1.800], [1.998, 0.000, 0.999, 2.000]),
    (30, [0.346, -0.200, 0.000], [1.998, 0.000, 1.999, 0.000]),
    (30, [0.346, -0.200, 0.900], [1.998, 0.000, 1.999, 1.000]),
    (30, [0.346, -0.200, 1.800], [1.998, 0.000, 1.999, 2.000]),
    (30, [0.173, 0.300, 0.010], [0.999, 0.000, -1.001, 0.011]),
    (30, [0.173, 0.300, 0.910], [0.999, 0.000, -1.001, 1.011]),
    (30, [0.173, 0.300, 1.810], [0.999, 0.000, -1.001, 2.011]),
    (30, [0.173, 0.100, 0.010], [0.999, 0.000, -0.001, 0.011]),
    (30, [0.173, 0.100, 0.910], [0.999, 0.000, -0.001, 1.011]),
    (30, [0.173, 0.100, 1.810], [0.999, 0.000, -0.001, 2.011]),
    (30, [0.173, -0.100, 0.010], [0.999, 0.000, 0.999, 0.011]),
    (30, [0.173, -0.100, 0.910], [0.999, 0.000, 0.999, 1.011]),
    (30, [0.173, -0.100, 1.810], [0.999, 0.000, 0.999, 2.011]),
    (30, [0.000, 0.400, 0.020], [-0.000, 0.000, -2.000, 0.022]),
    (30, [0.000, 0.400, 0.920], [0.000, 0.000, -2.000, 1.022]),
    (30, [0.000, 0.400, 1.820], [-0.000, 0.000, -2.000, 2.022]),
    (30, [0.000, 0.200, 0.020], [-0.000, 0.000, -1.000, 0.022]),
    (30, [0.000, 0.200, 0.920], [0.000, 0.000, -1.000, 1.022]),
    (30, [0.000, 0.200, 1.820], [-0.000, 0.000, -1.000, 2.022]),
    (30, [-0.000, 0.000, 0.020], [0.000, 0.000, 0.000, 0.022]),
    (30, [-0.000, 0.000, 0.920], [0.000, 0.000, 0.000, 1.022]),
    (30, [-0.000, 0.000, 1.820], [0.000, 0.000, 0.000, 2.022]),
    (40, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (40, [0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (40, [0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (40, [0.035, -0.197, 0.000], [0.001, 0.000, 1.001, 0.000]),
    (40, [0.035, -0.197, 0.900], [0.001, 0.000, 1.001, 1.000]),
    (40, [0.035, -0.197, 1.800], [0.001, 0.000, 1.001, 2.000]),
    (40, [0.069, -0.394, 0.000], [-0.003, 0.000, 1.999, 0.000]),
    (40, [0.069, -0.394, 0.900], [-0.003, 0.000, 1.999, 1.000]),
    (40, [0.069, -0.394, 1.800], [-0.003, 0.000, 1.999, 2.000]),
    (40, [-0.188, 0.068, 0.010], [-1.001, 0.000, -0.998, 0.011]),
    (40, [-0.188, 0.068, 0.910], [-1.001, 0.000, -0.998, 1.011]),
    (40, [-0.188, 0.068, 1.810], [-1.001, 0.000, -0.998, 2.011]),
    (40, [-0.153, -0.129, 0.010], [-0.999, 0.000, 0.003, 0.011]),
    (40, [-0.153, -0.129, 0.910], [-0.999, 0.000, 0.003, 1.011]),
    (40, [-0.153, -0.129, 1.810], [-0.999, 0.000, 0.003, 2.011]),
    (40, [-0.118, -0.326, 0.010], [-0.998, 0.000, 1.004, 0.011]),
    (40, [-0.118, -0.326, 0.910], [-0.998, 0.000, 1.004, 1.011]),
    (40, [-0.118, -0.326, 1.810], [-0.998, 0.000, 1.004, 2.011]),
    (40, [-0.376, 0.137, 0.020], [-2.001, 0.000, -2.001, 0.022]),
    (40, [-0.376, 0.137, 0.920], [-2.001, 0.000, -2.001, 1.022]),
    (40, [-0.376, 0.137, 1.820], [-2.001, 0.000, -2.001, 2.022]),
    (40, [-0.341, -0.060, 0.020], [-1.999, 0.000, -1.000, 0.022]),
    (40, [-0.341, -0.060, 0.920], [-1.999, 0.000, -1.000, 1.022]),
    (40, [-0.341, -0.060, 1.820], [-1.999, 0.000, -1.000, 2.022]),
    (40, [-0.306, -0.257, 0.020], [-1.998, 0.000, 0.001, 0.022]),
    (40, [-0.306, -0.257, 0.920], [-1.998, 0.000, 0.001, 1.022]),
    (40, [-0.306, -0.257, 1.820], [-1.998, 0.000, 0.001, 2.022]),
    (40, [0.153, 0.129, 0.000], [0.999, 0.000, -0.003, 0.000]),
    (40, [0.153, 0.129, 0.900], [0.999, 0.000, -0.003, 1.000]),
    (40, [0.153, 0.129, 1.800], [0.999, 0.000, -0.003, 2.000]),
    (40, [0.188, -0.068, 0.000], [1.001, 0.000, 0.998, 0.000]),
    (40, [0.188, -0.068, 0.900], [1.001, 0.000, 0.998, 1.000]),
    (40, [0.188, -0.068, 1.800], [1.001, 0.000, 0.998, 2.000]),
    (40, [0.223, -0.265, 0.000], [1.002, 0.000, 2.000, 0.000]),
    (40, [0.223, -0.265, 0.900], [1.002, 0.000, 2.000, 1.000]),
    (40, [0.223, -0.265, 1.800], [1.002, 0.000, 2.000, 2.000]),
    (40, [-0.035, 0.197, 0.010], [-0.001, 0.000, -1.001, 0.011]),
    (40, [-0.035, 0.197, 0.910], [-0.001, 0.000, -1.001, 1.011]),
    (40, [-0.035, 0.197, 1.810], [-0.001, 0.000, -1.001, 2.011]),
    (40, [-0.000, 0.000, 0.010], [0.000, 0.000, 0.000, 0.011]),
    (40, [-0.000, 0.000, 0.910], [0.000, 0.000, 0.000, 1.011]),
    (40, [-0.000, 0.000, 1.810], [0.000, 0.000, 0.000, 2.011]),
    (40, [0.035, -0.197, 0.010], [0.001, 0.000, 1.001, 0.011]),
    (40, [0.035, -0.197, 0.910], [0.001, 0.000, 1.001, 1.011]),
    (40, [0.035, -0.197, 1.810], [0.001, 0.000, 1.001, 2.011]),
    (40, [-0.223, 0.265, 0.020], [-1.002, 0.000, -2.000, 0.022]),
    (40, [-0.223, 0.265, 0.920], [-1.002, 0.000, -2.000, 1.022]),
    (40, [-0.223, 0.265, 1.820], [-1.002, 0.000, -2.000, 2.022]),
    (40, [-0.188, 0.068, 0.020], [-1.001, 0.000, -0.998, 0.022]),
    (40, [-0.188, 0.068, 0.920], [-1.001, 0.000, -0.998, 1.022]),
    (40, [-0.188, 0.068, 1.820], [-1.001, 0.000, -0.998, 2.022]),
    (40, [-0.153, -0.129, 0.020], [-0.999, 0.000, 0.003, 0.022]),
    (40, [-0.153, -0.129, 0.920], [-0.999, 0.000, 0.003, 1.022]),
    (40, [-0.153, -0.129, 1.820], [-0.999, 0.000, 0.003, 2.022]),
    (40, [0.306, 0.257, 0.000], [1.998, 0.000, -0.001, 0.000]),
    (40, [0.306, 0.257, 0.900], [1.998, 0.000, -0.001, 1.000]),
    (40, [0.306, 0.257, 1.800], [1.998, 0.000, -0.001, 2.000]),
    (40, [0.341, 0.060, 0.000], [1.999, 0.000, 1.000, 0.000]),
    (40, [0.341, 0.060, 0.900], [1.999, 0.000, 1.000, 1.000]),
    (40, [0.341, 0.060, 1.800], [1.999, 0.000, 1.000, 2.000]),
    (40, [0.376, -0.137, 0.000], [2.001, 0.000, 2.001, 0.000]),
    (40, [0.376, -0.137, 0.900], [2.001, 0.000, 2.001, 1.000]),
    (40, [0.376, -0.137, 1.800], [2.001, 0.000, 2.001, 2.000]),
    (40, [0.118, 0.326, 0.010], [0.998, 0.000, -1.004, 0.011]),
    (40, [0.118, 0.326, 0.910], [0.998, 0.000, -1.004, 1.011]),
    (40, [0.118, 0.326, 1.810], [0.998, 0.000, -1.004, 2.011]),
    (40, [0.153, 0.129, 0.010], [0.999, 0.000, -0.003, 0.011]),
    (40, [0.153, 0.129, 0.910], [0.999, 0.000, -0.003, 1.011]),
    (40, [0.153, 0.129, 1.810], [0.999, 0.000, -0.003, 2.011]),
    (40, [0.188, -0.068, 0.010], [1.001, 0.000, 0.998, 0.011]),
    (40, [0.188, -0.068, 0.910], [1.001, 0.000, 0.998, 1.011]),
    (40, [0.188, -0.068, 1.810], [1.001, 0.000, 0.998, 2.011]),
    (40, [-0.069, 0.394, 0.020], [0.003, 0.000, -1.999, 0.022]),
    (40, [-0.069, 0.394, 0.920], [0.003, 0.000, -1.999, 1.022]),
    (40, [-0.069, 0.394, 1.820], [0.003, 0.000, -1.999, 2.022]),
    (40, [-0.035, 0.197, 0.020], [-0.001, 0.000, -1.001, 0.022]),
    (40, [-0.035, 0.197, 0.920], [-0.001, 0.000, -1.001, 1.022]),
    (40, [-0.035, 0.197, 1.820], [-0.001, 0.000, -1.001, 2.022]),
    (40, [-0.000, 0.000, 0.020], [0.000, 0.000, 0.000, 0.022]),
    (40, [-0.000, 0.000, 0.920], [0.000, 0.000, 0.000, 1.022]),
    (40, [-0.000, 0.000, 1.820], [0.000, 0.000, 0.000, 2.022]),
    (50, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000, 0.000]),
    (50, [0.000, 0.000, 0.900], [0.000, 0.000, 0.000, 1.000]),
    (50, [0.000, 0.000, 1.800], [0.000, 0.000, 0.000, 2.000]),
    (50, [0.068, -0.188, 0.000], [-0.002, 0.000, 0.998, 0.000]),
    (50, [0.068, -0.188, 0.900], [-0.002, 0.000, 0.998, 1.000]),
    (50, [0.068, -0.188, 1.800], [-0.002, 0.000, 0.998, 2.000]),
    (50, [0.137, -0.376, 0.000], [0.001, 0.000, 2.001, 0.000]),
    (50, [0.137, -0.376, 0.900], [0.001, 0.000, 2.001, 1.000]),
    (50, [0.137, -0.376, 1.800], [0.001, 0.000, 2.001, 2.000]),
    (50, [-0.197, 0.035, 0.010], [-1.000, 0.000, -1.001, 0.011]),
    (50, [-0.197, 0.035, 0.910], [-1.000, 0.000, -1.001, 1.011]),
    (50, [-0.197, 0.035, 1.810], [-1.000, 0.000, -1.001, 2.011]),
    (50, [-0.129, -0.153, 0.010], [-1.002, 0.000, -0.003, 0.011]),
    (50, [-0.129, -0.153, 0.910], [-1.002, 0.000, -0.003, 1.011]),
    (50, [-0.129, -0.153, 1.810], [-1.002, 0.000, -0.003, 2.011]),
    (50, [-0.060, -0.341, 0.010], [-0.999, 0.000, 1.000, 0.011]),
    (50, [-0.060, -0.341, 0.910], [-0.999, 0.000, 1.000, 1.011]),
    (50, [-0.060, -0.341, 1.810], [-0.999, 0.000, 1.000, 2.011]),
    (50, [-0.394, 0.069, 0.020], [-2.001, 0.000, -1.999, 0.022]),
    (50, [-0.394, 0.069, 0.920], [-2.001, 0.000, -1.999, 1.022]),
    (50, [-0.394, 0.069, 1.820], [-2.001, 0.000, -1.999, 2.022]),
    (50, [-0.326, -0.118, 0.020], [-2.002, 0.000, -1.004, 0.022]),
    (50, [-0.326, -0.118, 0.920], [-2.002, 0.000, -1.004, 1.022]),
    (50, [-0.326, -0.118, 1.820], [-2.002, 0.000, -1.004, 2.022]),
    (50, [-0.257, -0.306, 0.020], [-1.999, 0.000, -0.001, 0.022]),
    (50, [-0.257, -0.306, 0.920], [-1.999, 0.000, -0.001, 1.022]),
    (50, [-0.257, -0.306, 1.820], [-1.999, 0.000, -0.001, 2.022]),
    (50, [0.129, 0.153, 0.000], [1.002, 0.000, 0.003, 0.000]),
    (50, [0.129, 0.153, 0.900], [1.002, 0.000, 0.003, 1.000]),
    (50, [0.129, 0.153, 1.800], [1.002, 0.000, 0.003, 2.000]),
    (50, [0.197, -0.035, 0.000], [1.000, 0.000, 1.001, 0.000]),
    (50, [0.197, -0.035, 0.900], [1.000, 0.000, 1.001, 1.000]),
    (50, [0.197, -0.035, 1.800], [1.000, 0.000, 1.001, 2.000]),
    (50, [0.265, -0.223, 0.000], [0.997, 0.000, 2.000, 0.000]),
    (50, [0.265, -0.223, 0.900], [0.997, 0.000, 2.000, 1.000]),
    (50, [0.265, -0.223, 1.800], [0.997, 0.000, 2.000, 2.000]),
    (50, [-0.068, 0.188, 0.010], [0.002, 0.000, -0.998, 0.011]),
    (50, [-0.068, 0.188, 0.910], [0.002, 0.000, -0.998, 1.011]),
    (50, [-0.068, 0.188, 1.810], [0.002, 0.000, -0.998, 2.011]),
    (50, [-0.000, 0.000, 0.010], [0.000, 0.000, 0.000, 0.011]),
    (50, [-0.000, 0.000, 0.910], [0.000, 0.000, 0.000, 1.011]),
    (50, [-0.000, 0.000, 1.810], [0.000, 0.000, 0.000, 2.011]),
    (50, [0.068, -0.188, 0.010], [-0.002, 0.000, 0.998, 0.011]),
    (50, [0.068, -0.188, 0.910], [-0.002, 0.000, 0.998, 1.011]),
    (50, [0.068, -0.188, 1.810], [-0.002, 0.000, 0.998, 2.011]),
    (50, [-0.265, 0.223, 0.020], [-0.997, 0.000, -2.000, 0.022]),
    (50, [-0.265, 0.223, 0.920], [-0.997, 0.000, -2.000, 1.022]),
    (50, [-0.265, 0.223, 1.820], [-0.997, 0.000, -2.000, 2.022]),
    (50, [-0.197, 0.035, 0.020], [-1.000, 0.000, -1.001, 0.022]),
    (50, [-0.197, 0.035, 0.920], [-1.000, 0.000, -1.001, 1.022]),
    (50, [-0.197, 0.035, 1.820], [-1.000, 0.000, -1.001, 2.022]),
    (50, [-0.129, -0.153, 0.020], [-1.002, 0.000, -0.003, 0.022]),
    (50, [-0.129, -0.153, 0.920], [-1.002, 0.000, -0.003, 1.022]),
    (50, [-0.129, -0.153, 1.820], [-1.002, 0.000, -0.003, 2.022]),
    (50, [0.257, 0.306, 0.000], [1.999, 0.000, 0.001, 0.000]),
    (50, [0.257, 0.306, 0.900], [1.999, 0.000, 0.001, 1.000]),
    (50, [0.257, 0.306, 1.800], [1.999, 0.000, 0.001, 2.000]),
    (50, [0.326, 0.118, 0.000], [2.002, 0.000, 1.004, 0.000]),
    (50, [0.326, 0.118, 0.900], [2.002, 0.000, 1.004, 1.000]),
    (50, [0.326, 0.118, 1.800], [2.002, 0.000, 1.004, 2.000]),
    (50, [0.394, -0.069, 0.000], [2.001, 0.000, 1.999, 0.000]),
    (50, [0.394, -0.069, 0.900], [2.001, 0.000, 1.999, 1.000]),
    (50, [0.394, -0.069, 1.800], [2.001, 0.000, 1.999, 2.000]),
    (50, [0.060, 0.341, 0.010], [0.999, 0.000, -1.000, 0.011]),
    (50, [0.060, 0.341, 0.910], [0.999, 0.000, -1.000, 1.011]),
    (50, [0.060, 0.341, 1.810], [0.999, 0.000, -1.000, 2.011]),
    (50, [0.129, 0.153, 0.010], [1.002, 0.000, 0.003, 0.011]),
    (50, [0.129, 0.153, 0.910], [1.002, 0.000, 0.003, 1.011]),
    (50, [0.129, 0.153, 1.810], [1.002, 0.000, 0.003, 2.011]),
    (50, [0.197, -0.035, 0.010], [1.000, 0.000, 1.001, 0.011]),
    (50, [0.197, -0.035, 0.910], [1.000, 0.000, 1.001, 1.011]),
    (50, [0.197, -0.035, 1.810], [1.000, 0.000, 1.001, 2.011]),
    (50, [-0.137, 0.376, 0.020], [-0.001, 0.000, -2.001, 0.022]),
    (50, [-0.137, 0.376, 0.920], [-0.001, 0.000, -2.001, 1.022]),
    (50, [-0.137, 0.376, 1.820], [-0.001, 0.000, -2.001, 2.022]),
    (50, [-0.068, 0.188, 0.020], [0.002, 0.000, -0.998, 0.022]),
    (50, [-0.068, 0.188, 0.920], [0.002, 0.000, -0.998, 1.022]),
    (50, [-0.068, 0.188, 1.820], [0.002, 0.000, -0.998, 2.022]),
    (50, [-0.000, 0.000, 0.020], [0.000, 0.000, 0.000, 0.022]),
    (50, [-0.000, 0.000, 0.920], [0.000, 0.000, 0.000, 1.022]),
    (50, [-0.000, 0.000, 1.820], [0.000, 0.000, 0.000, 2.022]),
    ])
def test_calcs_kompass_2(alpha, field, currents, session):
    prec = 0.002

    gf = session.getDevice('gf4_f')
    alphastorage = session.getDevice('alphastorage')

    assert gf.read(0) is None

    alphastorage.maw(-alpha)

    session.log.debug('Initial field (mT): %s', field)
    session.log.debug('Current matrix: %s', gf._currentmatrix)
    ccurrents = gf._b2i(field)
    session.log.debug(
        'Currents (in A) calculated from field %s: expected: %s, '
        'calculated: %s', field, currents, ccurrents)
    assert all(c == pytest.approx(cc, abs=prec)
               for c, cc in zip(currents, ccurrents))

    cfield = gf._i2b(currents)
    session.log.debug('Calculated field (mT) %s from currents (in A): %s',
                      cfield, currents)


@pytest.mark.parametrize(('alpha', 'field', 'currents'), [
    (0, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000]),
    (0, [0.000, 0.000, 1.165], [0.000, 0.000, 1.000]),
    (0, [0.000, 0.000, 2.330], [0.000, 0.000, 2.000]),
    (0, [0.053, -0.053, 0.000], [-0.000, 1.000, 0.000]),
    (0, [0.053, -0.053, 1.165], [-0.000, 1.000, 1.000]),
    (0, [0.053, -0.053, 2.330], [-0.000, 1.000, 2.000]),
    (0, [0.106, -0.106, 0.000], [-0.000, 2.000, 0.000]),
    (0, [0.106, -0.106, 1.165], [-0.000, 2.000, 1.000]),
    (0, [0.106, -0.106, 2.330], [-0.000, 2.000, 2.000]),
    (0, [0.053, 0.053, 0.000], [1.000, -0.000, 0.000]),
    (0, [0.053, 0.053, 1.165], [1.000, -0.000, 1.000]),
    (0, [0.053, 0.053, 2.330], [1.000, -0.000, 2.000]),
    (0, [0.106, 0.000, 0.000], [1.000, 1.000, 0.000]),
    (0, [0.106, 0.000, 1.165], [1.000, 1.000, 1.000]),
    (0, [0.106, 0.000, 2.330], [1.000, 1.000, 2.000]),
    (0, [0.159, -0.053, 0.000], [1.000, 2.000, 0.000]),
    (0, [0.159, -0.053, 1.165], [1.000, 2.000, 1.000]),
    (0, [0.159, -0.053, 2.330], [1.000, 2.000, 2.000]),
    (0, [0.106, 0.106, 0.000], [2.000, -0.000, 0.000]),
    (0, [0.106, 0.106, 1.165], [2.000, -0.000, 1.000]),
    (0, [0.106, 0.106, 2.330], [2.000, -0.000, 2.000]),
    (0, [0.159, 0.053, 0.000], [2.000, 1.000, 0.000]),
    (0, [0.159, 0.053, 1.165], [2.000, 1.000, 1.000]),
    (0, [0.159, 0.053, 2.330], [2.000, 1.000, 2.000]),
    (0, [0.212, 0.000, 0.000], [2.000, 2.000, 0.000]),
    (0, [0.212, 0.000, 1.165], [2.000, 2.000, 1.000]),
    (0, [0.212, 0.000, 2.330], [2.000, 2.000, 2.000]),

    (10, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000]),
    (10, [0.000, 0.000, 1.165], [0.000, 0.000, 1.000]),
    (10, [0.000, 0.000, 2.330], [0.000, 0.000, 2.000]),
    (10, [0.061, -0.043, 0.000], [-0.003, 0.996, 0.000]),
    (10, [0.061, -0.043, 1.165], [-0.003, 0.996, 1.000]),
    (10, [0.061, -0.043, 2.330], [-0.003, 0.996, 2.000]),
    (10, [0.123, -0.086, 0.000], [0.001, 2.002, 0.000]),
    (10, [0.123, -0.086, 1.165], [0.001, 2.002, 1.000]),
    (10, [0.123, -0.086, 2.330], [0.001, 2.002, 2.000]),
    (10, [0.043, 0.061, 0.000], [0.996, 0.003, 0.000]),
    (10, [0.043, 0.061, 1.165], [0.996, 0.003, 1.000]),
    (10, [0.043, 0.061, 2.330], [0.996, 0.003, 2.000]),
    (10, [0.104, 0.018, 0.000], [0.993, 0.999, 0.000]),
    (10, [0.104, 0.018, 1.165], [0.993, 0.999, 1.000]),
    (10, [0.104, 0.018, 2.330], [0.993, 0.999, 2.000]),
    (10, [0.166, -0.025, 0.000], [0.997, 2.005, 0.000]),
    (10, [0.166, -0.025, 1.165], [0.997, 2.005, 1.000]),
    (10, [0.166, -0.025, 2.330], [0.997, 2.005, 2.000]),
    (10, [0.086, 0.123, 0.000], [2.002, -0.001, 0.000]),
    (10, [0.086, 0.123, 1.165], [2.002, -0.001, 1.000]),
    (10, [0.086, 0.123, 2.330], [2.002, -0.001, 2.000]),
    (10, [0.147, 0.080, 0.000], [1.999, 0.994, 0.000]),
    (10, [0.147, 0.080, 1.165], [1.999, 0.994, 1.000]),
    (10, [0.147, 0.080, 2.330], [1.999, 0.994, 2.000]),
    (10, [0.209, 0.037, 0.000], [2.004, 2.001, 0.000]),
    (10, [0.209, 0.037, 1.165], [2.004, 2.001, 1.000]),
    (10, [0.209, 0.037, 2.330], [2.004, 2.001, 2.000]),

    (20, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000]),
    (20, [0.000, 0.000, 1.165], [0.000, 0.000, 1.000]),
    (20, [0.000, 0.000, 2.330], [0.000, 0.000, 2.000]),
    (20, [0.068, -0.032, 0.000], [-0.004, 1.003, 0.000]),
    (20, [0.068, -0.032, 1.165], [-0.004, 1.003, 1.000]),
    (20, [0.068, -0.032, 2.330], [-0.004, 1.003, 2.000]),
    (20, [0.136, -0.063, 0.000], [0.005, 2.000, 0.000]),
    (20, [0.136, -0.063, 1.165], [0.005, 2.000, 1.000]),
    (20, [0.136, -0.063, 2.330], [0.005, 2.000, 2.000]),
    (20, [0.032, 0.068, 0.000], [1.003, 0.004, 0.000]),
    (20, [0.032, 0.068, 1.165], [1.003, 0.004, 1.000]),
    (20, [0.032, 0.068, 2.330], [1.003, 0.004, 2.000]),
    (20, [0.100, 0.036, 0.000], [0.999, 1.006, 0.000]),
    (20, [0.100, 0.036, 1.165], [0.999, 1.006, 1.000]),
    (20, [0.100, 0.036, 2.330], [0.999, 1.006, 2.000]),
    (20, [0.168, 0.005, 0.000], [1.008, 2.003, 0.000]),
    (20, [0.168, 0.005, 1.165], [1.008, 2.003, 1.000]),
    (20, [0.168, 0.005, 2.330], [1.008, 2.003, 2.000]),
    (20, [0.063, 0.136, 0.000], [2.000, -0.005, 0.000]),
    (20, [0.063, 0.136, 1.165], [2.000, -0.005, 1.000]),
    (20, [0.063, 0.136, 2.330], [2.000, -0.005, 2.000]),
    (20, [0.131, 0.104, 0.000], [1.996, 0.998, 0.000]),
    (20, [0.131, 0.104, 1.165], [1.996, 0.998, 1.000]),
    (20, [0.131, 0.104, 2.330], [1.996, 0.998, 2.000]),
    (20, [0.199, 0.073, 0.000], [2.005, 1.995, 0.000]),
    (20, [0.199, 0.073, 1.165], [2.005, 1.995, 1.000]),
    (20, [0.199, 0.073, 2.330], [2.005, 1.995, 2.000]),

    (30, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000]),
    (30, [0.000, 0.000, 1.165], [0.000, 0.000, 1.000]),
    (30, [0.000, 0.000, 2.330], [0.000, 0.000, 2.000]),
    (30, [0.072, -0.019, 0.000], [0.004, 0.993, 0.000]),
    (30, [0.072, -0.019, 1.165], [0.004, 0.993, 1.000]),
    (30, [0.072, -0.019, 2.330], [0.004, 0.993, 2.000]),
    (30, [0.145, -0.039, 0.000], [-0.002, 2.003, 0.000]),
    (30, [0.145, -0.039, 1.165], [-0.002, 2.003, 1.000]),
    (30, [0.145, -0.039, 2.330], [-0.002, 2.003, 2.000]),
    (30, [0.019, 0.072, 0.000], [0.993, -0.004, 0.000]),
    (30, [0.019, 0.072, 1.165], [0.993, -0.004, 1.000]),
    (30, [0.019, 0.072, 2.330], [0.993, -0.004, 2.000]),
    (30, [0.092, 0.053, 0.000], [1.001, 1.003, 0.000]),
    (30, [0.092, 0.053, 1.165], [1.001, 1.003, 1.000]),
    (30, [0.092, 0.053, 2.330], [1.001, 1.003, 2.000]),
    (30, [0.164, 0.034, 0.000], [1.004, 1.996, 0.000]),
    (30, [0.164, 0.034, 1.165], [1.004, 1.996, 1.000]),
    (30, [0.164, 0.034, 2.330], [1.004, 1.996, 2.000]),
    (30, [0.039, 0.145, 0.000], [2.003, 0.002, 0.000]),
    (30, [0.039, 0.145, 1.165], [2.003, 0.002, 1.000]),
    (30, [0.039, 0.145, 2.330], [2.003, 0.002, 2.000]),
    (30, [0.111, 0.125, 0.000], [1.994, 0.999, 0.000]),
    (30, [0.111, 0.125, 1.165], [1.994, 0.999, 1.000]),
    (30, [0.111, 0.125, 2.330], [1.994, 0.999, 2.000]),
    (30, [0.184, 0.106, 0.000], [2.001, 2.005, 0.000]),
    (30, [0.184, 0.106, 1.165], [2.001, 2.005, 1.000]),
    (30, [0.184, 0.106, 2.330], [2.001, 2.005, 2.000]),

    (40, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000]),
    (40, [0.000, 0.000, 1.165], [0.000, 0.000, 1.000]),
    (40, [0.000, 0.000, 2.330], [0.000, 0.000, 2.000]),
    (40, [0.075, -0.007, 0.000], [-0.006, 1.005, 0.000]),
    (40, [0.075, -0.007, 1.165], [-0.006, 1.005, 1.000]),
    (40, [0.075, -0.007, 2.330], [-0.006, 1.005, 2.000]),
    (40, [0.149, -0.013, 0.000], [0.000, 1.995, 0.000]),
    (40, [0.149, -0.013, 1.165], [0.000, 1.995, 1.000]),
    (40, [0.149, -0.013, 2.330], [0.000, 1.995, 2.000]),
    (40, [0.007, 0.075, 0.000], [1.005, 0.006, 0.000]),
    (40, [0.007, 0.075, 1.165], [1.005, 0.006, 1.000]),
    (40, [0.007, 0.075, 2.330], [1.005, 0.006, 2.000]),
    (40, [0.081, 0.068, 0.000], [0.998, 0.997, 0.000]),
    (40, [0.081, 0.068, 1.165], [0.998, 0.997, 1.000]),
    (40, [0.081, 0.068, 2.330], [0.998, 0.997, 2.000]),
    (40, [0.156, 0.062, 0.000], [1.005, 2.001, 0.000]),
    (40, [0.156, 0.062, 1.165], [1.005, 2.001, 1.000]),
    (40, [0.156, 0.062, 2.330], [1.005, 2.001, 2.000]),
    (40, [0.013, 0.149, 0.000], [1.995, -0.000, 0.000]),
    (40, [0.013, 0.149, 1.165], [1.995, -0.000, 1.000]),
    (40, [0.013, 0.149, 2.330], [1.995, -0.000, 2.000]),
    (40, [0.088, 0.143, 0.000], [2.003, 1.003, 0.000]),
    (40, [0.088, 0.143, 1.165], [2.003, 1.003, 1.000]),
    (40, [0.088, 0.143, 2.330], [2.003, 1.003, 2.000]),
    (40, [0.162, 0.136, 0.000], [1.996, 1.995, 0.000]),
    (40, [0.162, 0.136, 1.165], [1.996, 1.995, 1.000]),
    (40, [0.162, 0.136, 2.330], [1.996, 1.995, 2.000]),

    (50, [0.000, 0.000, 0.000], [0.000, 0.000, 0.000]),
    (50, [0.000, 0.000, 1.165], [0.000, 0.000, 1.000]),
    (50, [0.000, 0.000, 2.330], [0.000, 0.000, 2.000]),
    (50, [0.075, 0.007, 0.000], [0.006, 1.005, 0.000]),
    (50, [0.075, 0.007, 1.165], [0.006, 1.005, 1.000]),
    (50, [0.075, 0.007, 2.330], [0.006, 1.005, 2.000]),
    (50, [0.149, 0.013, 0.000], [-0.000, 1.995, 0.000]),
    (50, [0.149, 0.013, 1.165], [-0.000, 1.995, 1.000]),
    (50, [0.149, 0.013, 2.330], [-0.000, 1.995, 2.000]),
    (50, [-0.007, 0.075, 0.000], [1.005, -0.006, 0.000]),
    (50, [-0.007, 0.075, 1.165], [1.005, -0.006, 1.000]),
    (50, [-0.007, 0.075, 2.330], [1.005, -0.006, 2.000]),
    (50, [0.068, 0.081, 0.000], [0.997, 0.998, 0.000]),
    (50, [0.068, 0.081, 1.165], [0.997, 0.998, 1.000]),
    (50, [0.068, 0.081, 2.330], [0.997, 0.998, 2.000]),
    (50, [0.143, 0.088, 0.000], [1.003, 2.003, 0.000]),
    (50, [0.143, 0.088, 1.165], [1.003, 2.003, 1.000]),
    (50, [0.143, 0.088, 2.330], [1.003, 2.003, 2.000]),
    (50, [-0.013, 0.149, 0.000], [1.995, 0.000, 0.000]),
    (50, [-0.013, 0.149, 1.165], [1.995, 0.000, 1.000]),
    (50, [-0.013, 0.149, 2.330], [1.995, 0.000, 2.000]),
    (50, [0.062, 0.156, 0.000], [2.001, 1.005, 0.000]),
    (50, [0.062, 0.156, 1.165], [2.001, 1.005, 1.000]),
    (50, [0.062, 0.156, 2.330], [2.001, 1.005, 2.000]),
    (50, [0.136, 0.162, 0.000], [1.995, 1.996, 0.000]),
    (50, [0.136, 0.162, 1.165], [1.995, 1.996, 1.000]),
    (50, [0.136, 0.162, 2.330], [1.995, 1.996, 2.000]),
    ])
def test_calcs_panda(alpha, field, currents, session):
    prec = 0.005

    gf = session.getDevice('gf3')
    alphastorage = session.getDevice('alphastorage')

    assert gf.read(0) is None

    alphastorage.maw(-alpha)

    session.log.debug('Initial field (mT): %s', field)
    session.log.debug('Current matrix: %s', gf._currentmatrix)
    ccurrents = gf._b2i(field)
    session.log.debug(
        'Currents (in A) calculated from field %s: expected: %s, '
        'calculated: %s', field, currents, ccurrents)
    assert all(c == pytest.approx(cc, abs=prec)
               for c, cc in zip(currents, ccurrents))

    cfield = gf._i2b(currents)
    session.log.debug('Calculated field (mT) %s from currents (in A): %s',
                      cfield, currents)
    assert all(f == pytest.approx(cf, abs=prec)
               for f, cf in zip(field, cfield))
